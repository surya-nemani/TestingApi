# File: .github/workflows/workflow.yml

name: Run Azure Login with System-assigned Managed Identity
on:
  push:
    branches:
    - master

permissions:
  id-token: write
  contents: read
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Azure login
        uses: azure/login@v2
        with:
          client-id: "87cea4f5-2467-4a80-9573-7489aa6c8419"  # ${{ secrets.AZURE_CLIENT_ID }}
          tenant-id: "4baf6c69-c1dd-43dd-8fc6-e1ef405f2633"  # "${{ secrets.AZURE_TENANT_ID }}
          subscription-id: "29c2e57b-d84c-41de-bc3e-015e798a1c58"  # ${{ secrets.AZURE_SUBSCRIPTION_ID }}

      - name: Azure CLI script
        uses: azure/cli@v2
        with:
          azcliversion: latest
          inlineScript: |
            az account show

#jobs:
#  build-and-deploy:
#    runs-on: self-hosted
#    steps:
#      - name: Azure login
#        uses: azure/login@v2
#        with:
#          auth-type: IDENTITY
#          tenant-id: ${{ secrets.AZURE_TENANT_ID }}
#          subscription-id: ${{ secrets.AZURE_SUBSCRIPTION_ID }}
#          enable-AzPSSession: true

      # Azure CLI Action only supports linux self-hosted runners for now.
      # If you want to execute the Azure CLI script on a windows self-hosted runner, you can execute it directly in `run`.
#      - name: Azure CLI script
#        uses: azure/cli@v2
#        with:
#          azcliversion: latest
#          inlineScript: |
#            az account show

#      - name: Azure PowerShell script
#        uses: azure/powershell@v2
#        with:
#          azPSVersion: "latest"
#          inlineScript: |
#            Get-AzContext
#            Get-AzResourceGroup
